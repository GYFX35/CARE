{% extends "base.html" %}

{% block content %}
    <h1>Podcasts & Videos</h1>
    <p><a href="{{ url_for('submit_podcast') }}">Submit a new podcast/video</a></p>
    <hr>
    {% for podcast in podcasts %}
        <article class="podcast">
            <h2>{{ podcast.title }}</h2>
            <p>Submitted by <a href="{{ url_for('user', username=podcast.author.username) }}">{{ podcast.author.username }}</a> on {{ podcast.timestamp.strftime('%Y-%m-%d') }}</p>
            <p>{{ podcast.description }}</p>
            <div class="video-container">
                {% if 'youtube.com' in podcast.video_url or 'youtu.be' in podcast.video_url %}
                    {% set video_id = podcast.video_url.split('v=')[-1] if 'v=' in podcast.video_url else podcast.video_url.split('/')[-1] %}
                    <iframe width="560" height="315" src="https://www.youtube.com/embed/{{ video_id }}" frameborder="0" allowfullscreen></iframe>
                {% else %}
                    <a href="{{ podcast.video_url }}" target="_blank">Watch Video</a>
                {% endif %}
            </div>
            <hr>
        </article>
    {% endfor %}
{% endblock %}